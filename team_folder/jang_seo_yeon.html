<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="../js/jquery-3.7.1.min.js"></script>

    <link href="../css/common.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">

    <title>3ì¡° : ë³´ëŒì‚¼ì¡°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gowun+Dodum&display=swap');

        * {
            font-family: 'Gowun Dodum', sans-serif;
        }

        body {
            margin: 0;
            padding: 100px;
            background-color: rgb(231, 243, 252);
            color: black;
        }

        .container {
            width: 80%;
            max-width: 1000px;
            background-color: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
        }

        img {
            width: 50%;
            height: auto;
        }

        #profile {
            font-size: 3rem;
        }

        #name {
            font-size: 2rem;
        }

        table {
            width: 80%;
            border-collapse: collapse;
            margin: auto;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 12px 20px;
            text-align: left;
            vertical-align: middle;
            font-size: 1.5rem;
            word-break: break-word;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .post {
            margin-top: 20px;
        }

        .post h4 {
            text-align: center;
            margin-bottom: 10px;
        }

        .btn_area {
            text-align: right;
        }

        #add_btn {
            background-color: #00235a;
            color: #fff;
            padding: 1rem;
            border-radius: 10%;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2 id="profile">Profile</h2>
        <br>

        <div>
            <img src="C:\Users\0jsjs\Desktop\1ì£¼ì°¨ë¯¸ë‹ˆí”„ë¡œì íŠ¸\3jo_web\img\jang_seo_yeon\í”„ë¡œí•„.jpg">
            <h3 id="name">ì¥ì„œì—°</h3>

            <p id="birth_date">2002.10.16<br>ì†Œí”„íŠ¸ì›¨ì–´ê³¼ 4í•™ë…„</p>
            <p id="content"></p>


        </div>

        <div>
            <table>
                <tbody>
                    <tr>
                        <th scope="row">MBTI</th>
                        <td>INTP / ë‚´í–¥í˜• 90%</td>
                    </tr>
                    <tr>
                        <th scope="row">ì¢‹ì•„í•˜ëŠ” ê²ƒ</th>
                        <td>ê³ ì–‘ì´ğŸ±, í•˜ëŠ˜ìƒ‰â˜ï¸, ë§ˆë¼íƒ•ğŸœ, ì§‘ğŸ </td>
                    </tr>
                    <tr>
                        <th scope="row">velog</th>
                        <td><a href="https://velog.io/@syjang1016">https://velog.io/@syjang1016</a></td>
                    </tr>
                    <tr>
                        <th scope="row">ëª©í‘œ</th>
                        <td>í˜‘ì—… ëŠ¥ë ¥ ê¸°ë¥´ê¸°, í¬íŠ¸í´ë¦¬ì˜¤ ìŒ“ê¸°, ê¾¸ì¤€í•¨</td>
                    </tr>
                </tbody>
            </table>

        </div>


        <div class="post"> <!--ë°©ëª…ë¡-->
            <h4>ë°©ëª…ë¡</h4>
            <div class="btn_area">
                <button type="button" class="add_btn" id="add_btn">ì‘ì„±í•˜ê¸°</button>
            </div>
        </div>

        <div id="guestbook">
            <div class="gb_row">
                <label for="gb_comment">ë°©ëª…ë¡ ë‚´ìš©</label>
                <input id="gb_comment" rows="4" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" />
            </div>
            <div class="gb_row">
                <label for="gb_pwd">ë¹„ë°€ë²ˆí˜¸</label>
                <input maxlength=4 type="password" id="gb_pwd" placeholder="ìˆ«ì 4ìë¦¬ ì…ë ¥" />
            </div>
            <div>
                <button type="button" id="save_btn">ë“±ë¡</button>
            </div>
        </div>

        <div id="comment_list">


        </div>
    </div>



    </div>
</body>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import {
        getFirestore,
        collection,
        addDoc,
        serverTimestamp,
        getDocs,
        query,
        orderBy
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyCOfKG6lP22IAQ0b_0YzHhaoqEEGQDiSIU",
        authDomain: "sparta-10a22.firebaseapp.com",
        projectId: "sparta-10a22",
        storageBucket: "sparta-10a22.firebasestorage.app",
        messagingSenderId: "141923072753",
        appId: "1:141923072753:web:e82145d4c5de4e0d1ac750",
        measurementId: "G-YL2K2ST8Y6"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    $("#save_btn").click(async function () {
        try {
            let comment = $('#gb_comment').val();
            let pwd = $('#gb_pwd').val();

            if (!comment && !pwd)
                return alert('ë‚´ìš©ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
            else if (!comment)
                return alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
            else if (!pwd)
                return alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');


            await addDoc(collection(db, "comments"), {
                comment: comment,
                //comment_id: comment_id_cnt,
                created_at: serverTimestamp(),
                pwd: pwd
            });
            alert('ì €ì¥ì™„ë£Œ!');
            window.location.reload();
        } catch (e) {
            console.error("Error adding document: ", e);
        }
    });

    async function load_comments() {
        const querySnapshot = await getDocs(query(collection(db, "comments"), orderBy("created_at", "desc")));

        $("#comment_list").empty();

        querySnapshot.forEach((doc) => {
            const data = doc.data();
            const comment = data.comment ?? "(ë‚´ìš© ì—†ìŒ)";

            const temp_html = `<p>${comment}</p>`;

            $("#comment_list").append(temp_html);
        });
    }

    load_comments();




</script>
<html>